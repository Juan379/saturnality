<!DOCTYPE html>
<html lang="en">

<nav class="navbar">
  <div class="navbar-brand">
    <a class="navbar-item" href="https://bulma.io">
      <img src="https://bulma.io/images/bulma-logo.png" alt="Bulma: a modern CSS framework based on Flexbox" width="112" height="28">
    </a>
    <div class="navbar-burger burger" data-target="navbarExampleTransparentExample">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <div id="navbarBasicExample" class="navbar-menu">
    <div class="navbar-start">
      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          Parties
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" <%= link_to 'Search for a party', parties_url %>
          </a>
          <a class="navbar-item" <%= link_to "Create Party", new_party_url %>
          </a>
        </div>
      </div>

      <div class="navbar-item has-dropdown is-hoverable">
        <a class="navbar-link">
          Services
        </a>

        <div class="navbar-dropdown">
          <a class="navbar-item" <%= link_to 'view services', services_url %>
          </a>
          <a class="navbar-item" <%= link_to "Create Service", new_service_url %>
          </a>
        </div>
      </div>

      <% if not current_user %>
        <div class="navbar-end">
          <div class="navbar-item">
            <div class="buttons">
              <a class="button is-light" <%= link_to 'Log in', new_user_session_path %>
              </a>
              <a class="button is-primary" <%= link_to 'Sign up', new_user_registration_path %>
              </a>
            </div>
          </div>
        </div>

      <% else %>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Profile
          </a>

          <div class="navbar-dropdown">
            <a class="navbar-item">
              View profile
            </a>
            <a class="navbar-item" <%= link_to "Edit Profile", edit_user_registration_path %>
            </a>
            <hr class="navbar-divider">
            <a class="navbar-item" <%= link_to "Log Out", destroy_user_session_path, :method => :delete %>
            </a>
          </div>
        </div>
        </div>


      <% end %>
      </div>
  </div>
</nav>

<h1 class="title">Available Parties</h1> <br/>
<% flash.each do |type, msg| %>
  <div>
    <%= msg %>
  </div>
<% end %>
<% if current_user %>
    <%= link_to "Create Party", new_party_url %> <br/>
<% end %>

<% if @parties.empty? %>
    <h3>There are no active parties.</h3>
<% else %> 
    <table>
        <tr>
            <thead>
                <th>Name</th>
            </thead>
        </tr>
            <% @parties.each do |party| %>
        <tr>
            <td><%= party.title %></td>
            <td>
                <%= link_to "Show", party %>
                <% if current_user && current_user == party.user %>
                    <%= link_to "Edit", edit_party_path(party) %>
                    <%= link_to "Delete", party, method: :delete, data: { confirm: "Do you really want to delete this Party?"} %>
                <% end %>
                <% if current_user && current_user.has_role?(:admin) %>
                    <%= link_to "Edit", edit_party_path(party) %>
                    <%= link_to "Delete", party, method: :delete, data: { confirm: "Do you really want to delete this Party?"} %>
                <% end %>
            </td>
        </tr>
            <% end %>
    </table>
<% end %>

